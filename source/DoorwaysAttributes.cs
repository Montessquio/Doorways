using SecretHistories.Entities;
using SecretHistories.Fucine;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Threading.Tasks;

namespace Doorways
{

    /// <summary>
    /// Signals to Doorways that this class can be loaded
    /// as a Fucine Importable. It must be a child class of
    /// an existing Fucine class or a Doorways entity class.
    /// </summary>
    [AttributeUsage(AttributeTargets.Class)]
    public class DoorwaysObjectAttribute : Attribute { }

    /// <summary>
    /// A shorthand signal to Doorways that this enum
    /// can be used as a Fucine DeckSpec.
    /// Optionally, a default item may be specified.
    /// If no default item is specified, the
    /// deck will loop by default.
    /// <para />
    /// In order to specify deck text (for portal deckspecs)
    /// add the <see cref="DrawTextAttribute"/> attribute
    /// to each enum item.
    /// </summary>
    [AttributeUsage(AttributeTargets.Enum)]
    public class DeckAttribute : Attribute
    {
        public string defaultKey = null;
        public DeckAttribute() { }
        public DeckAttribute(string defaultKey)
        {
            this.defaultKey = defaultKey;
        }
    }

    /// <summary>
    /// Add this to a <see cref="DeckAttribute"/>
    /// enum in order to specify the text that
    /// will be shown then that card is pulled
    /// when the deck is drawn from as a portal
    /// deck.
    /// </summary>
    [AttributeUsage(AttributeTargets.All)]
    public class DrawTextAttribute : Attribute
    {
        string text;
        public DrawTextAttribute(string text)
        {
            this.text = text;
        }
    }

    /// <summary>
    /// Classes that derive from DoorwaysFactory
    /// can procedurally generate as many entities
    /// as they like at load time.
    /// </summary>
    public interface IDoorwaysFactory
    {
        /// <summary>
        /// Retrieve all the entities generated by this factory.
        /// </summary>
        IEnumerable<IEntityWithId> GetAll();
    }

    /// <summary>
    /// Signals to Doorways that this recipe's
    /// dynamic function should be evaluated
    /// each time the recipe finishes.
    /// <para />
    /// This interface does nothing when attached
    /// to non-recipes.
    /// </summary>
    public interface IDynamicRecipe
    {
        void OnPostExecute(Situation __instance);
    }

    /// <summary>
    /// Add this to any property in your
    /// <see cref="DoorwaysObjectAttribute"/>
    /// class. Doorways will then cause the
    /// property's getter and/or setter to be
    /// run every time they would be invoked
    /// by an instance on the table, instead
    /// of once at run-time.
    /// </summary>
    [AttributeUsage(AttributeTargets.Property)]
    public class DynamicAttribute : Attribute
    {

    }

    /// <summary>
    /// Define the root namespace all your mod objects will be defined in.
    /// If it's not present, the namespace will be the same as mod's ID.
    /// </summary>
    [AttributeUsage(AttributeTargets.Assembly)]
    public class DoorwaysAttribute : Attribute
    {
        public string Name = null;
        public string Prefix = null;

        public DoorwaysAttribute() { }
    }

    /// <summary>
    /// The attached static method should be run when the mod is loaded.
    /// </summary>
    [AttributeUsage(AttributeTargets.Method)]
    public class DoorwaysInitAttribute : Attribute { }

    /// <summary>
    /// The attached class' members which shadow the matching
    /// method or property in the parameter class will forcibly
    /// override the shadowed members in the provided class.
    /// </summary>
    public interface IInheritOverride<T> { }
}
